mmu04060
![](./500uM-ATP pathway/mmu04060.pathview.png)
setwd("F:/git/R-codes/sslab/DC")
mmu05144
![](./3uM-ATP pathway/mmu05144.pathview.png)
mmu05144
![](./3uM-ATP pathway/mmu05144.pathview.png)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(biomaRt)
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F)
library(readxl)
dc <- read_xlsx(path = "reads-counts.xlsx", header = T)
?read_xlsx
dc <- read_xlsx(path = "reads-counts.xlsx")
dc
dc <- read_xlsx(path = "reads-counts.xlsx", col_names = F)
dc
dc <- read_xlsx(path = "reads-counts.xlsx")
dc
dc <- dc[, -1]
dc
colnames(dc) <- c("Symbol", "ATP_3uM", "ATP_3uM+inh", "ATP_500uM", "COntrol")
dc
colnames(dc) <- c("Symbol", "ATP_3uM", "ATP_3uM+inh", "ATP_500uM", "Control")
dc
lib.size <- colSums(dc[, -1])
lib.size
dc[,2:5] <- apply(dc[, 2:5], 2, function(x){(x * 1e6) / lib.size})
dc
dc <- dc %>%
mutate(atp.3_vs_ctl_fc = ATP_3uM / Control)
dc
index <- c()
for(i in 1:dim(dc)[1]){
index <- c(index, sum(dc[i, 2:5] >= 1) >= 2)
}
dc <- dc[index, ]
dc <- dc %>%
mutate(atp.3_vs_ctl_fc = ATP_3uM / Control)
dc
lib.size
dc %>%
filter(atp.3_vs_ctl_fc >= 3 | atp.3_vs_ctl_fc <= 1/3)
fc3_3_vs_ctl <- dc %>%
filter(atp.3_vs_ctl_fc >= 3 | atp.3_vs_ctl_fc <= 1/3) %>%
rownames()
fc3_3_vs_ctl
fc3_3_vs_ctl <- dc %>%
filter(atp.3_vs_ctl_fc >= 3 | atp.3_vs_ctl_fc <= 1/3) %>%
.[, 1]
fc3_3_vs_ctl
fc3_3_vs_ctl <- dc %>%
filter(atp.3_vs_ctl_fc >= 3 | atp.3_vs_ctl_fc <= 1/3) %>%
.[, 1, drop = T]
fc3_3_vs_ctl
migration <- dc[dc$Symbol == fc3_3_vs_ctl, ]
migration
dc
fc3_3_vs_ctl
dc[dc$Symbol == fc3_3_vs_ctl, ]
migration <- dc[dc$Symbol == fc3_3_vs_ctl, ]
migration
dc[dc$Symbol == fc3_3_vs_ctl, ]
dc
fc3_3_vs_ctl
fc3_3_vs_ctl %>% class()
dc$Symbol == fc3_3_vs_ctl %>% table()
library(magrittr)
dc$Symbol == fc3_3_vs_ctl %>% table()
dc[dc$Symbol %in% fc3_3_vs_ctl, ]
migration <- dc[dc$Symbol %in% fc3_3_vs_ctl, ]
migration
write.table(x = migration, file = "3um ATP vs Control FC3.csv")
mmart <- useEnsembl(biomart = "ensembl", dataset = "mmusculus_gene_ensembl")
listAttributes(mmart, page = "feature_page")
genes <- getBM(attributes = c("go_id", "name_1006"),
filters = "mgi_symbol",
values = migration$Symbol,
mart = mmart)
genes
genes <- getBM(attributes = c("go_id", "name_1006", "namespace_1003"),
filters = "mgi_symbol",
values = migration$Symbol,
mart = mmart)
genes
genes %>%
filter(namespace_1003 == "biological_process")
genes <- getBM(attributes = c("name_1006", "namespace_1003", "mgi_symbol"),
filters = "mgi_symbol",
values = migration$Symbol,
mart = mmart)
genes %>%
filter(namespace_1003 == "biological_process")
knitr::opts_chunk$set(echo = F, message = F, warning = F, comment = "")
go_atp.3 %>%
filter(Ont == "BP", P.DE <= 0.05)
genes %>%
filter(namespace_1003 == "biological_process", name_1006 %in% c("migration", "localization"))
genes %>%
filter(namespace_1003 == "biological_process")
genes %>%
filter(namespace_1003 == "biological_process") %>%
.[,1] %>% contains(match = c("migration"))
BP_genes <- genes %>%
filter(namespace_1003 == "biological_process")
genes
index <- grep(pattern = "migration|localization|motility|movement|")
index <- grep(pattern = "migration|localization|motility|movement|", x = BP_genes$name_1006)
index
?grep
grep(pattern = "migration|localization|motility|movement|", x = BP_genes$name_1006)
grep(pattern = "migration|localization|motility|movement|", x = BP_genes$name_1006, ignore.case = T)
BP_genes
?gsub
grep(pattern = "(migration|localization|motility|movement|)", x = BP_genes$name_1006, ignore.case = T)
grepl(pattern = "(migration|localization|motility|movement|)", x = BP_genes$name_1006, ignore.case = T)
grepl(pattern = "migration", x = BP_genes$name_1006, ignore.case = T)
grepl(pattern = "migration", x = BP_genes$name_1006, ignore.case = T) %>% table()
grepl(pattern = "migration|movement", x = BP_genes$name_1006, ignore.case = T) %>% table()
grepl(pattern = "migration|movement|localization", x = BP_genes$name_1006, ignore.case = T) %>% table()
grepl(pattern = "migration|movement|localization|motility", x = BP_genes$name_1006, ignore.case = T) %>% table()
movement_index <- grepl(pattern = "migration|movement|localization|motility|",
x = BP_genes$name_1006, ignore.case = T)
BP_genes$mgi_symbol[movement_index]
BP_genes$mgi_symbol[movement_index] %>% unique()
BP_genes[movement_index, ] %>% unique()
BP_genes[movement_index, ] %>% .[mgi_symbol]
BP_genes[movement_index, ] %>% .[,mgi_symbol]
BP_genes[movement_index, ]
movement_index %>% table()
movement_index <- grepl(pattern = "migration|movement|localization|motility",
x = BP_genes$name_1006, ignore.case = T)
movement_index %>% table()
BP_genes[movement_index, ]
BP_genes[movement_index, ] %>% .[, 3]
BP_genes[movement_index, ] %>% .[, 3] %>% unique()
movement_genes <- BP_genes[movement_index, ] %>% .[, 3] %>% unique()
movement_genes
migration
migration$related_to_movement <- ifelse(migration$Symbol %in% movement_genes, "Yes", "NO")
migration
migration$related_to_movement <- ifelse(migration$Symbol %in% movement_genes, "Yes", "No")
migration
migration %>% arrange(atp.3_vs_ctl_fc)
migration %>% arrange(desc(atp.3_vs_ctl_fc))
write.table(x = migration %>% arrange(desc(atp.3_vs_ctl_fc)), file = "3um ATP vs Control FC3.csv")
write.csv(x = migration %>% arrange(desc(atp.3_vs_ctl_fc)), file = "3um ATP vs Control FC3.csv")
?write.csv
write.csv(x = migration %>% arrange(desc(atp.3_vs_ctl_fc)),
file = "3um ATP vs Control FC3.csv",
row.names = F,
quote = F)
